name: Run security scans

on:
    workflow_dispatch:
      inputs:
        manifest-path:
          description: 'Path to the sbomber manifest file'
          required: true
          default: 'ssdlc/<manifest>.yaml'

jobs:
  SSDLC:
    runs-on: [self-hosted-linux-amd64-jammy-private-endpoint-medium]
    permissions:
      contents: read
    steps:
      - uses: actions/checkout@v4
      - name: Install uv
        uses: astral-sh/setup-uv@d0cc045d04ccac9d8b7881df0226f9e82c39688e  # v6.8.0
      - name: Run sbomber
        # FIXME: switch to official action when ready
        uses: Saviq/sbomber/.github/actions/run@mir
        with:
          sbomber-ref: mir
          manifest: '${{ github.workspace }}/${{ github.event.inputs.manifest-path }}'
          artifact-name: "results"
